<!---
;;
;;  This softeware is Copyright (c) 2009 A.F. Haffmans 
;;
;;    This file is part of cl-bliky.
;;
;;    cl-bliky is free software: you can redistribute it and/or modify
;;    it under the terms of the GNU General Public License as published by
;;   the Free Software Foundation, either version 3 of the License, or
;;    (at your option) any later version.
;;
;;    cl-bliky is distributed in the hope that it will be useful,
;;    but WITHOUT ANY WARRANTY; without even the implied warranty of
;;    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
;;    GNU General Public License for more details.
;;
;;    You should have received a copy of the GNU General Public License
;;    along with cl-bliky.  If not, see <http://www.gnu.org/licenses/>.
;;
;;

--->

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html>
  <head>
    <title> Programmer Notes  </title>
    <style type="text/css">
      /*-------------------------------------------------------------------
;;
;;  This softeware is Copyright (c) 2009 A.F. Haffmans 
;;
;;    This file is part of cl-bliky.
;;
;;    cl-bliky is free software: you can redistribute it and/or modify
;;    it under the terms of the GNU General Public License as published by
;;   the Free Software Foundation, either version 3 of the License, or
;;    (at your option) any later version.
;;
;;    cl-bliky is distributed in the hope that it will be useful,
;;    but WITHOUT ANY WARRANTY; without even the implied warranty of
;;    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
;;    GNU General Public License for more details.
;;
;;    You should have received a copy of the GNU General Public License
;;    along with cl-bliky.  If not, see <http://www.gnu.org/licenses/>.
;;
;;

--------------------------------------------------------------------------*/


/*-----------------------------------------------------------------------------
Sheet   : All sheets
Purpose : General Formatting 
Comment : Default formatting, no tied to any template or div

This is probably NOT the right way, since I created specific formatting under
the 'general' settings, esp H1...

-------------------------------------------------------------------------------*/

body{
      margin:0px;
      padding:0x;
      #background:#ffffff;
      background:#eee9e9;
      #background:#fffacd;
      #color:#000011;
      font-size : 12px;
      font:normal 100% Sans-Serif;
      background-image:url('http://github.com/fons/blog-images/raw/master/background/bliky-background.png');
      
      }

p {
    margin:0px;
    padding:0x;
    ####background:#ffffff;
    background:#eee9e9;
    #color:#000011;
    font-size : 12px;
    font:normal 100% Sans-Serif;


    }

a{
   #padding:2px;
   margin:0px 0px 0px 0px;
   width:100%;
   border:none;
   color:#0000cc;
   text-decoration:none;
   }

a:hover{
         text-decoration:none;
         }

a:visited{
           color:#0000cc;
           }

h1,h2,h3,h4,h5,h6{
                   color:#595959;
                   #color:black;
                   #color:darkblue;
                   font:bold 100% Sans-Serif;
                   #padding:0px 0px 0px 0px;
                   margin:5px 0px 5px 0px;
                   #margin:0px 0px 5px 0px;
                   width:100%;
                   text-align:left;
                   }
h1 {
     font-size:180%;
     }


h2 {
     font-size:160%;
     }

h3 {
     font-size:110%;
     color:black;

     }

pre {  }

code{
      #border: 0.30em solid #D6D6D6;
      border-left: 0.3em solid #D6D6D6;
      display: block;
      padding: 1em 1em 1em 1em;
      color:#330066;
      background:#EDEDED;
      }


/*---------------------------------------------------------------
Sheet   : Index page
Purpose : Formats the main column
Comment : Basically sets up a two column format
       
----------------------------------------------------------------*/

#mainClm{
          float:left;
          padding:13px 50px 10px 5%;
          width:68%;
          }


/*---------------------------------------------------------------
Sheet   : All pages
Purpose : Formats the blog title
Comment : Seperate format for the blog title
       
----------------------------------------------------------------*/
#blog-title {
              width:100%;
              padding: 10px 0px 0px 100px;
              #float:left;
              }


#blog-title h1 {
                 color: #0000cc;
                 font:bold 580% Sans-Serif;
                 #width:100%;
                 #padding: 0px 0px 0px 0px;
                 #border: 0.15em solid #D6D6D6;
                }


/*---------------------------------------------------------------
Sheet   : Import Page
Purpose : formats the import page
Comment : 
       
----------------------------------------------------------------*/

#import-header h1 {
                    color: #0000cc;
                    font:bold Sans-Serif;
                    width:100%;
                    padding:15px 0px 0px 0px;
                    font-size: 240%;
                    #border-bottom:solid 4px #0000cc;
                    }

#import-edit h1, h2, h3 h4, h5 {
                                 padding:0px 0px 0px 0px;
                                 color: #0000cc;
                                 font:bold Verdana,Sans-Serif;
                                 width:100%;
                                 #border-bottom:solid 2px #0000cc;
                                 }

#import-edit h2 {
                  font-size: 160%;
                  }


/*---------------------------------------------------------------
Sheet   : Index Page / index.tmpl
Purpose : Formats the side bar
Comment : This is the sidebar to the left of the page
       
----------------------------------------------------------------*/

#sideBar{
          padding:220px 0px 0px 0px;
          text-align:left;
          #background:#eee9e9;
          #background:black;
          #color:#111111;
          font-size : 12px;
          #font:normal 100% Sans-Serif;
          font:bold 150% Sans-Serif;
          }

#sideBar p {
             margin:0px 0px 0px 0px;
             text-align:left;
             #background:#eee9e9;
             #font-size : 12px;
             #font-size : 20px;
             #font:normal 100% Sans-Serif;
             }

#sideBar h2 {
              #color:#0000cc;
              #font-size:120%;
              #font-size : 20px;
             }

#sideBar ul{
             margin:0px 0px 33px 0px;
             list-style-type:none;
             #font-size:100%;
             }

#sideBar li {
              list-style-type:none;
              color:#111111;
              }

#sideBar a {
             #color:#555555
             color:red;
             }

#sideBar a:hover {
                   border-bottom: solid 2px red;
                   }

#sideBar ul a{
               #color:#555555;
               color:black;##FF8000;
               list-style-type:underline;
               }

#contact a {
             #color:#555555
             }

#contact a:hover {
                   text-decoration:none;
                   }

#contact a:visited{
                    color:#0000cc;
                    }


/*-------------------------------------------------------------------------
Sheet   : Index and post sheets
Purpose : Format the postings
Comment : each post has a post and post-intro division
This is probably NOT the right way, since I created specific formatting under
the 'general' settings.

--------------------------------------------------------------------------*/
/* h2 is also used for the blog post title...
   h6 is special; it's used to format the 'continue reading ..' link    
*/

#post { 
        margin:  1em 1em 1em 1em;
        padding: 1em 1em 1em 1em;
        border: 0.1em solid #FF8000;
        background:#F5F5F5;
        }

#post p { 
          background:#F5F5F5;
        }


/* h2 is also used for the blog post title...*/
#post h2 {
           border-bottom:solid 1px #000000;
           color: #0000cc;
           font:bold 160% Sans-Serif;
           }


/*this is a special format to bring h2 in line with the other formats..*/

#post-intro h2 {
                 #color:#595959;
                 color:black;
                 border-bottom:dotted 0px #cccccc;
                 font-size:140%;
                 }

#post-body h2 {
                color:#595959;
                #color:black;
                border-bottom:dotted 0px #cccccc;
                font-size:140%;
                }

/* h6 is special; it's used to format the 'continue reading ..' link */
#post h6 {
          margin:4px 0px 0px 0px;
          color:#0000cc;
          #font-family : 'Sans Serif';
          font-size   : 14px;
          font-weight : bold;
          }


/*---------------------------------------------------------------
Sheet   : Index and post sheets
Purpose : Format the visible time stamp
Comment : Each blog post has a time stamp in a specific div. 

----------------------------------------------------------------*/
#post-timestamp p {  
                    margin:0px 0px 18px 0px;
                    border-bottom-width : 4px;
                    color : #cc0000;
                    #font-family : , 'Sans Serif',;
                    font-size : 12px;
                    height : 4px;

                    }

/*---------------------------------------------------------------
Sheet   : Index sheet
Purpose : Format the footer
Comment : Basically sets up a footer pointing to the bliky location
          on github, with a barely visible link ref.

----------------------------------------------------------------*/
#footer p { 
            #font-family : , 'Sans Serif',;           
            font-size:.75em;
            margin-top: 3em;
            text-align: center;
            text-indent: 0;
           }
#footer a { color:#222222; }

#footer a:hover {
                  border-bottom: solid 2px red;
                  }


/* ---------------------------------------------------------------------
Sheet       : post-edit.tmpl
Purpose     : edit a blog post
Comment     : These are the styles used when editing 
a blog post

-----------------------------------------------------------------------*/
#edit-page{
            float:left;
            padding:13px 50px 10px 5%;
            width:80%;
            }


#edit-header {                
               margin:0px 0px 0px 0px;
               font-size:240%;
               }

#edit-header h1 { 
                  margin:0px 0px 0px 0px;
                  color:salmon; 
                  text-align: center;
                  }

#intro-buttons {  
                 margin:8px 0px 8px 0px;
                 #background:#caff70;
                 background:#f5deb3;
                 border:solid 1px #cd0000;
}

#intro-buttons input {  
                      margin:2px 0px 2px 0px;
                      text-align:left;
                      #width:48%;
                      font-family : 'Sans Serif';
                      font-size : 20px;
                      #background:#F5F5F5;
                      #background:#caff70;
                       background:#d3d3d3;
                      }                       

#intro-edit input {  
                    margin:20px 0px 20px 0px;
                    text-align:left;
                    width:100%;
                    font-family : 'Sans Serif';
                    font-size : 18px;
                    #background:#F5F5F5;
                    background:#f5deb3;
                    }                       

#intro-edit textarea {  
                       margin:0px 0px 0px 0px;
                       text-align:left;
                       width:100%;
                       font-family : 'Sans Serif';
                       font-size : 18px;
                       #background:#F5F5F5;
                       background:#f5deb3;
                       }                       

#intro-edit h2 {
                 border-bottom:solid 1px #000000;
                 color: #0000cc;
                 font:bold 110% Verdana,Sans-Serif;
                 }


/*--------------end of post-edit.tmpl style -------------------------*/
/* ---------------------------------------------------------------------
Sheet       : import.tmpl
Purpose     : import a repo
Comment     : These are the styles used when importing a repo
               

-----------------------------------------------------------------------*/
#import-page{
            float:left;
            padding:13px 50px 10px 5%;
            width:80%;
            }


#import-header {                
               margin:0px 0px 0px 0px;
               font-size:240%;
               }

#import-header h1 { 
                  margin:0px 0px 0px 0px;
                  color:salmon; 
                  text-align: center;
                  }


/*--------------end of import.tmpl style -------------------------*/

/* ---------------------------------------------------------------------
Sheet       : import.tmpl
Purpose     : import a repo
Comment     : These are the styles used when importing a repo
-----------------------------------------------------------------------*/

#options-header {                
                  margin:0px 0px 0px 0px;
                  font-size:240%;
                  }

#options-header h1 { 
                     margin:0px 0px 0px 0px;
                     color:salmon; 
                     text-align: center;
                     }

#options-page{
               float:left;
               padding:10px 0px 0px 50px;
               width:80%;
               font-size: 100%;
               }


/*----------------- end of options style ----------------------------*/


    </style>
  </head>  

  <body>
    <div id="blog-title">
      <a href="/"> <h1> Programmer Notes </h1> </a> 
    </div>
    
    <div id="mainClm">
      <div id="post">
	<div id="post-type" style="visibility:hidden">
	  <p>"post"</p>
	</div>
	<div id="post-timestamp" >
	  <p>Sat, 29 Aug 2009 19:15:49 EST </p>
	</div>
	<div id="post-header">
	  <h2> Simplified command line processing with dyn-options.py  </h2>
	</div>
	<div id="post-intro">
	  <p>Am I the only one in the world who feels that using python's  <em>getopt</em> is a bit of a struggle ? It involves a lot of boiler plate. Tedious refactoring is required each time you add or change an option.  This is not specific to Python, as most languages have a similar facility to parse the command line, which is similarly annoying. <br /> <br />  I decided to create an easier way to process command line options, by transforming the command line into an immutable (read-only) object. The result is <a href="http://github.com/fons/dyn_options/tree/master">dyn_options</a>. <br /> <br />  <a href="http://github.com/fons/dyn_options/tree/master">dyn_options</a> considers every string on the command line which starts with either  - or -- (i.e. a single or double dash) an option flag. The value of the option flag is a concatenation of everything that follows it, until the next flag is encountered.  A simple option flag is one without explicit values and is considered a boolean flag, set to <em>True</em>. <a href="http://github.com/fons/dyn_options/tree/master">dyn_options</a> creates a read-only object, with attributes and values set to the command line option flags and values respectively. <br /> <br />  So, '--opt4 hello world' will be converted to an option flag  called <em>opt4</em>, with a value of <em>hello world</em>. This makes dealing with spaces on the command line a lot easier. </p>
	</div>
	<div id="post-body">
	  <h3>Using <a href="http://github.com/fons/dyn_options/tree/master">dyn_options</a></h3><p>Here is how an option object is created : </p><pre><code>  import dyn_options   
 
  option = dyn_options.create_option(argv, option_defaults())  
</code></pre><p>If you have defaults, <em>option_defaults()</em> should return a dictionary of key-value pairs, with the key corresponding to the option, and its value to the desired default value. </p><p>An easy way to check whether an option is set, is to do something like : </p><pre><code>  if option.some_flag :   
          do_something   
           .......   
</code></pre><H3>A few examples</H3>  <P> You can play around with  <EM> example.py</EM>  to test how various options are handled. Here's the source: </P>  <pre><code>  #!/usr/bin/env python   
  import sys   
  import dyn_options   
 
  def option_defaults() :   
     return dict( [("opt1", "opt1_default"), ("help", False)])   
 
  def main(argv) :   
        option = dyn_options.create_option(argv, option_defaults())   
         print "using defaults :", option   
 
         option = dyn_options.create_option(argv)   
         print "no defaults :", option   
 
             if option.opt4 :   
                 print "opt4 is set :", option.opt4   
           else :   
                print "opt4 is not set"   
 
     if __name__ == '__main__':   
              sys.exit(main(sys.argv))   
 
</code></pre><p>I create two different <em>option</em> objects. The first one has defaults;  The second one doesn't. The output for </p><pre><code>    ./example.py --opt2 --opt4 hello world </code></pre><p>is this: </p><pre><code>     using defaults : options :   
        #) help ==&gt; False   
            #) program ==&gt; ./example.py   
            #) opt4 ==&gt; hello world   
            #) opt1 ==&gt; opt1_default   
            #) opt2 ==&gt; True   
 
   no defaults : options :   
           #) program ==&gt; ./example.py   
           #) opt4 ==&gt; hello world   
           #) opt2 ==&gt; True   
   opt4 is set : hello world </code></pre><P>When <EM> option</EM>  is initialized with the dictionary returned by <EM> option_defaults()</EM> ,<BR>  <EM> opt1</EM>  is set to the default value specified for it in the dictionary. In the second case, when no defaults are supplied, it's not set.  </P> <P> Here's the output for : <CODE> ./example.py --opt1 new_value</CODE>  </P>  <pre><code>  using defaults : options :   
       #) help ==&gt; False   
       #) program ==&gt; ./example.py   
       #) opt1 ==&gt; new_value   
   no defaults : options :   
       #) program ==&gt; ./example.py   
       #) opt1 ==&gt; new_value   
   opt4 is not set </code></pre><p>As you can see, the value of <EM>opt1</EM> is now the one provided on the command line, rather than the default. <BR> <BR><br />
</p><H3>Immutable/Read-Only</H3>  <p>This is one of the tests in <EM> dyn<em>options</em>test.py</EM> . It verifies that the <EM> option</EM>  remains unchanged, after it's been created. </P>  </p><pre><code>  def test4() :   
  """   
            option is immutable   
     """   
 
     L=['./dyn_options.py', '--opt1', 'opt1_value', '-opt2', 'opt2_value', '-opt3']   
    option = dyn_options.create_option(L, option_defaults())   
    try :   
        assert option.opt1 == "opt1_value"   
        assert option.opt2 == "opt2_value"   
        assert option.opt3 == True   
        assert option.help == False   
 
        #Try to override...   
        option.help = True   
        assert option.help == False   
 
        option.opt2 == "new_opt2_value"   
        assert option.opt2 == "opt2_value"   
 
 
        #Try to add new attribute   
        option.opt55 = "opt55_value"   
        assert option.opt55 == False   
 
     except AssertionError :   
          traceback.print_exc()   
 
          print "Failed test4 : parsing ", str(L)   
          print "generated : ", option   
          print "internals : ", option.__repr__()   
          return -1   
 
    print "pass test4"   
    return 0 </code></pre><P> You can't set additional attributes, nor override existing ones. This seems reasonable to me. Once your options are set, they should remain so. Notice that I don't throw an exception when try to override the value of option <EM>opt2</EM>. <BR> <BR><br />
</P> <H3> Internals</H3>  <P>  How does all of this work ? Very simple : The command line is converted to a dictionary, which in turn is used to initialize the internal dictionary <strong>dict</strong> of the <EM> options</EM>  object. I also override the <strong>getattr</strong> and <strong>setattr</strong> methods. Those are used to 'get' and 'set' elements of the internal dictionary, and need to be overridden to make the object read-only. </P>  <P> Enjoy. </P>   
	</div>
	<div id="post-timestamp-id" style="visibility:hidden">
	  <p>3460576549 </p>
	</div>
      </div>

      <div id="footer">
	<p>
	  Powered by <a href="http://www.github.com/fons/cl-bliky"> cl-bliky </a>
	</p>
      </div>
      
    </div><!-- end of main area -->

  </body>
</html>
