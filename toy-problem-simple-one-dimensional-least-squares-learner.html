<!---
;;
;;  This softeware is Copyright (c) 2009 A.F. Haffmans 
;;
;;    This file is part of cl-bliky.
;;
;;    cl-bliky is free software: you can redistribute it and/or modify
;;    it under the terms of the GNU General Public License as published by
;;   the Free Software Foundation, either version 3 of the License, or
;;    (at your option) any later version.
;;
;;    cl-bliky is distributed in the hope that it will be useful,
;;    but WITHOUT ANY WARRANTY; without even the implied warranty of
;;    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
;;    GNU General Public License for more details.
;;
;;    You should have received a copy of the GNU General Public License
;;    along with cl-bliky.  If not, see <http://www.gnu.org/licenses/>.
;;
;;

--->

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html>
  <head>
    <title> Programmer Notes  </title>
    <style type="text/css">
      /*-------------------------------------------------------------------
;;
;;  This softeware is Copyright (c) 2009 A.F. Haffmans 
;;
;;    This file is part of cl-bliky.
;;
;;    cl-bliky is free software: you can redistribute it and/or modify
;;    it under the terms of the GNU General Public License as published by
;;   the Free Software Foundation, either version 3 of the License, or
;;    (at your option) any later version.
;;
;;    cl-bliky is distributed in the hope that it will be useful,
;;    but WITHOUT ANY WARRANTY; without even the implied warranty of
;;    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
;;    GNU General Public License for more details.
;;
;;    You should have received a copy of the GNU General Public License
;;    along with cl-bliky.  If not, see <http://www.gnu.org/licenses/>.
;;
;;

--------------------------------------------------------------------------*/


/*-----------------------------------------------------------------------------
Sheet   : All sheets
Purpose : General Formatting 
Comment : Default formatting, no tied to any template or div

This is probably NOT the right way, since I created specific formatting under
the 'general' settings, esp H1...

-------------------------------------------------------------------------------*/

body{
      margin:0px;
      padding:0x;
      #background:#ffffff;
      background:#eee9e9;
      #background:#fffacd;
      #color:#000011;
      font-size : 12px;
      font:normal 100% Sans-Serif;
      background-image:url('http://github.com/fons/blog-images/raw/master/background/greenmountains.JPG');
      
      }

p {
    margin:0px;
    padding:0x;
    ####background:#ffffff;
    background:#eee9e9;
    #color:#000011;
    font-size : 12px;
    font:normal 100% Sans-Serif;


    }

a{
   #padding:2px;
   margin:0px 0px 0px 0px;
   width:100%;
   border:none;
   color:#0000cc;
   text-decoration:none;
   }

a:hover{
         text-decoration:none;
         }

a:visited{
           color:#0000cc;
           }

h1,h2,h3,h4,h5,h6{
                   color:#595959;
                   #color:black;
                   #color:darkblue;
                   font:bold 100% Sans-Serif;
                   #padding:0px 0px 0px 0px;
                   margin:5px 0px 5px 0px;
                   #margin:0px 0px 5px 0px;
                   width:100%;
                   text-align:left;
                   }
h1 {
     font-size:180%;
     }


h2 {
     font-size:160%;
     }

h3 {
     font-size:110%;
     color:black;

     }

pre {  }

code{
      #border: 0.30em solid #D6D6D6;
      border-left: 0.3em solid #D6D6D6;
      display: block;
      padding: 1em 1em 1em 1em;
      color:#330066;
      background:#EDEDED;
      }


/*---------------------------------------------------------------
Sheet   : Index page
Purpose : Formats the main column
Comment : Basically sets up a two column format
       
----------------------------------------------------------------*/

#mainClm{
          float:left;
          padding:13px 50px 10px 5%;
          width:68%;
          }


/*---------------------------------------------------------------
Sheet   : All pages
Purpose : Formats the blog title
Comment : Seperate format for the blog title
       
----------------------------------------------------------------*/
#blog-title {
              width:100%;
              padding: 10px 0px 0px 100px;
              #float:left;
              }


#blog-title h1 {
                 color: #0000cc;
                 font:bold 580% Sans-Serif;
                 #width:100%;
                 #padding: 0px 0px 0px 0px;
                 #border: 0.15em solid #D6D6D6;
                }


/*---------------------------------------------------------------
Sheet   : Import Page
Purpose : formats the import page
Comment : 
       
----------------------------------------------------------------*/

#import-header h1 {
                    color: #0000cc;
                    font:bold Sans-Serif;
                    width:100%;
                    padding:15px 0px 0px 0px;
                    font-size: 240%;
                    #border-bottom:solid 4px #0000cc;
                    }

#import-edit h1, h2, h3 h4, h5 {
                                 padding:0px 0px 0px 0px;
                                 color: #0000cc;
                                 font:bold Verdana,Sans-Serif;
                                 width:100%;
                                 #border-bottom:solid 2px #0000cc;
                                 }

#import-edit h2 {
                  font-size: 160%;
                  }


/*---------------------------------------------------------------
Sheet   : Index Page / index.tmpl
Purpose : Formats the side bar
Comment : This is the sidebar to the left of the page
       
----------------------------------------------------------------*/

#sideBar{
          padding:220px 0px 0px 0px;
          text-align:left;
          #background:#eee9e9;
          #background:black;
          #color:#111111;
          font-size : 12px;
          #font:normal 100% Sans-Serif;
          font:bold 150% Sans-Serif;
          }

#sideBar p {
             margin:0px 0px 0px 0px;
             text-align:left;
             #background:#eee9e9;
             #font-size : 12px;
             #font-size : 20px;
             #font:normal 100% Sans-Serif;
             }

#sideBar h2 {
              #color:#0000cc;
              #font-size:120%;
              #font-size : 20px;
             }

#sideBar ul{
             margin:0px 0px 33px 0px;
             list-style-type:none;
             #font-size:100%;
             }

#sideBar li {
              list-style-type:none;
              color:#111111;
              }

#sideBar a {
             #color:#555555
             color:red;
             }

#sideBar a:hover {
                   border-bottom: solid 2px red;
                   }

#sideBar ul a{
               #color:#555555;
               color:black;##FF8000;
               list-style-type:underline;
               }

#contact a {
             #color:#555555
             }

#contact a:hover {
                   text-decoration:none;
                   }

#contact a:visited{
                    color:#0000cc;
                    }


/*-------------------------------------------------------------------------
Sheet   : Index and post sheets
Purpose : Format the postings
Comment : each post has a post and post-intro division
This is probably NOT the right way, since I created specific formatting under
the 'general' settings.

--------------------------------------------------------------------------*/
/* h2 is also used for the blog post title...
   h6 is special; it's used to format the 'continue reading ..' link    
*/

#post { 
        margin:  1em 1em 1em 1em;
        padding: 1em 1em 1em 1em;
        border: 0.1em solid #FF8000;
        background:#F5F5F5;
        }

#post p { 
          background:#F5F5F5;
        }


/* h2 is also used for the blog post title...*/
#post h2 {
           border-bottom:solid 1px #000000;
           color: #0000cc;
           font:bold 160% Sans-Serif;
           }


/*this is a special format to bring h2 in line with the other formats..*/

#post-intro h2 {
                 #color:#595959;
                 color:black;
                 border-bottom:dotted 0px #cccccc;
                 font-size:140%;
                 }

#post-body h2 {
                color:#595959;
                #color:black;
                border-bottom:dotted 0px #cccccc;
                font-size:140%;
                }

/* h6 is special; it's used to format the 'continue reading ..' link */
#post h6 {
          margin:4px 0px 0px 0px;
          color:#0000cc;
          #font-family : 'Sans Serif';
          font-size   : 14px;
          font-weight : bold;
          }


/*---------------------------------------------------------------
Sheet   : Index and post sheets
Purpose : Format the visible time stamp
Comment : Each blog post has a time stamp in a specific div. 

----------------------------------------------------------------*/
#post-timestamp p {  
                    margin:0px 0px 18px 0px;
                    border-bottom-width : 4px;
                    color : #cc0000;
                    #font-family : , 'Sans Serif',;
                    font-size : 12px;
                    height : 4px;

                    }

/*---------------------------------------------------------------
Sheet   : Index sheet
Purpose : Format the footer
Comment : Basically sets up a footer pointing to the bliky location
          on github, with a barely visible link ref.

----------------------------------------------------------------*/
#footer p { 
            #font-family : , 'Sans Serif',;           
            font-size:.75em;
            margin-top: 3em;
            text-align: center;
            text-indent: 0;
           }
#footer a { color:#222222; }

#footer a:hover {
                  border-bottom: solid 2px red;
                  }


/* ---------------------------------------------------------------------
Sheet       : post-edit.tmpl
Purpose     : edit a blog post
Comment     : These are the styles used when editing 
a blog post

-----------------------------------------------------------------------*/
#edit-page{
            float:left;
            padding:13px 50px 10px 5%;
            width:80%;
            }


#edit-header {                
               margin:0px 0px 0px 0px;
               font-size:240%;
               }

#edit-header h1 { 
                  margin:0px 0px 0px 0px;
                  color:salmon; 
                  text-align: center;
                  }

#intro-buttons {  
                 margin:8px 0px 8px 0px;
                 #background:#caff70;
                 background:#f5deb3;
                 border:solid 1px #cd0000;
}

#intro-buttons input {  
                      margin:2px 0px 2px 0px;
                      text-align:left;
                      #width:48%;
                      font-family : 'Sans Serif';
                      font-size : 20px;
                      #background:#F5F5F5;
                      #background:#caff70;
                       background:#d3d3d3;
                      }                       

#intro-edit input {  
                    margin:20px 0px 20px 0px;
                    text-align:left;
                    width:100%;
                    font-family : 'Sans Serif';
                    font-size : 18px;
                    #background:#F5F5F5;
                    background:#f5deb3;
                    }                       

#intro-edit textarea {  
                       margin:0px 0px 0px 0px;
                       text-align:left;
                       width:100%;
                       font-family : 'Sans Serif';
                       font-size : 18px;
                       #background:#F5F5F5;
                       background:#f5deb3;
                       }                       

#intro-edit h2 {
                 border-bottom:solid 1px #000000;
                 color: #0000cc;
                 font:bold 110% Verdana,Sans-Serif;
                 }


/*--------------end of post-edit.tmpl style -------------------------*/
/* ---------------------------------------------------------------------
Sheet       : import.tmpl
Purpose     : import a repo
Comment     : These are the styles used when importing a repo
               

-----------------------------------------------------------------------*/
#import-page{
            float:left;
            padding:13px 50px 10px 5%;
            width:80%;
            }


#import-header {                
               margin:0px 0px 0px 0px;
               font-size:240%;
               }

#import-header h1 { 
                  margin:0px 0px 0px 0px;
                  color:salmon; 
                  text-align: center;
                  }


/*--------------end of import.tmpl style -------------------------*/

/* ---------------------------------------------------------------------
Sheet       : import.tmpl
Purpose     : import a repo
Comment     : These are the styles used when importing a repo
-----------------------------------------------------------------------*/

#options-header {                
                  margin:0px 0px 0px 0px;
                  font-size:240%;
                  }

#options-header h1 { 
                     margin:0px 0px 0px 0px;
                     color:salmon; 
                     text-align: center;
                     }

#options-page{
               float:left;
               padding:10px 0px 0px 50px;
               width:80%;
               font-size: 100%;
               }


/*----------------- end of options style ----------------------------*/


    </style>
  </head>  

  <body>
    <div id="blog-title">
      <a href="/"> <h1> Programmer Notes </h1> </a> 
    </div>
    
    <div id="mainClm">
      <div id="post">
	<div id="post-type" style="visibility:hidden">
	  <p>"post"</p>
	</div>
	<div id="post-timestamp" >
	  <p>Sun, 01 Nov 2009 10:30:37 EST </p>
	</div>
	<div id="post-header">
	  <h2> Toy Problem: Simple One Dimensional Least Squares Learner.  </h2>
	</div>
	<div id="post-intro">
	  <p>In chapter two of Hastie, Tibshirani and Friedman 's  <a href="http://www-stat.stanford.edu/~tibs/ElemStatLearn/">'The Elements of Statistical Learning'</a>  the authors discuss the use of least- squares regression to construct a data classifier for linearly separable data. <br /> <br />  A set of training data together with the least-squares method is used to construct a hyper-plane in the data space. The classification of a data point depends on what side of the hyper-plane you end up on.<br /> <br />  The example in Hastie uses two data classes in a two dimensional parameter space. I didn't grok the the example immediately, and I thought it would be helpful to try to construct my own much simpler example by staying in one dimension and using a simple normal distribution. The rest of this post describes the details. </p>
	</div>
	<div id="post-body">
	  <h2>Data Classes and Least Squares</h2><p>My data points are generated by two <a href="http://en.wikipedia.org/wiki/Normal_distribution">normal distributions.</a> with means on the interval [0,1].<br /> <br /> Class 1 is classified as -1 and class 2 as 1. In my example, class 1 will always have the smaller mean, and hence will lie to the left of class 2. As in  Hastie <a href="http://en.wikipedia.org/wiki/Linear_regression">linear regression.</a> is used to find a linear classifier for a set of training data for these two classes.<br /> <br />  The data space is one-dimensional and the classification boundary will be a point on the interval [0,1] somewhere between the means of the two data classes. For a one dimensional data space linear regression models the classification response function as a line:     y = Mx + Q </p><p>The RSS is the sum of the squares of the difference between the actual and response predicted by the LSM equation : </p><pre><code>RSS = SUM ( (y_obs - y_calc) ^2 ) </code></pre><p>LSM tries to find the slope M and intercept Q such that the responses  generated by the least-squares model (LSM) have the smallest 'residual sum of squared errors' (RSS). </p><p><em>x</em> represents the input and is going to be generated by the normal distributions associated with one of the two data classes. <em>y</em> represents the response and the only values are -1 or 1, depending on whether <em>x</em> was generated by the first or second class distribution respectively. </p><p>The observed classifications, <em>y_obs</em>, can have only one of two values : -1 or 1. The values generated by the LSM, <em>y_calc</em>, range from Q (for <em>x</em> = 0) to M + Q (for <em>x</em> = 1). </p><p>The LSM separates the space into two pieces, one for one class and one for the other. In this case the data space is the line piece [0,1], and the 'hyper-plane' separating that space is where the linear regression line crosses the data space, yielding a classification boundary of : </p><pre><code> S = -Q / M </code></pre><p>The LSM estimate of the classifier is then : </p><pre><code>x &lt; S -&gt; class 1  
x &gt; S -&gt; class 2  
</code></pre><h2>A simple R script</h2><p>I've put together a quick <a href="http://www.r-project.org/">R script</a>  implementing these ideas. </p><p>This [R script]( http://github.com/fons/blog-code/blob/master/1d-classification-toy/sl-1d-regression.R) has two main functions : <em>train</em> and <em>sim</em>. The script is loaded on the R command prompt like so: </p><pre><code>source('sl-1d-regression.R') </code></pre><p>The <em>train</em> function is used to generate a graph showing two data classes as well as the line generated by the LSM separating both classes. The example discussed below was generated using train as follows : </p><pre><code>&gt; train(20, 0.35, 0.15, 0.65, 0.15)  
  coefficients :  -1.916889  3.973720  
  classifier :  0.4824  
  prob of misclassification of class 1 :  0.16  
  prob of misclassification of class 2 :  0.16  
 
</code></pre><p>The <em>sim</em> function returns a vector of monte-carlo simulations of the separation boundary. For example, here's  10 values of the boundary generated by <em>sim</em> : </p><pre><code>&gt; sim(10, 0.35, 0.15, 0.65, 0.15)  
  (Intercept) (Intercept) (Intercept) (Intercept) (Intercept) (Intercept)  
   0.4495022   0.5185030   0.4978533   0.5887321   0.4547277   0.5029925  
  (Intercept) (Intercept) (Intercept) (Intercept)  
   0.4792027   0.5665940   0.4952061   0.5337139 </code></pre><p>The following plots the density function for 400 values of the classification boundary, for the same class parameters as the <em>train</em> example above. </p><pre><code>plot(density(sim(400, 0.15, 0.35, 0.65, 0.15)), xlim=c(0,1), xlab="", ylab="")  
</code></pre><p>Obviously, since these  are monte-carlo simulations, subsequent runs are going to be different as the random values generated by <em>rnorm</em> are going to be different each time the function is run. </p><h2>Classification Results</h2><p><a name="narrow1d"> <img src="http://github.com/fons/blog-images/raw/master/20091101/narrow1d.png">  </a>  </p>  </p><p><a href=""narrow1d"">This graph</a> shows two classes and the resulting least-squares model. Both distributions have the same standard deviation of 0.15. One class marked the with red inverted triangles has a mean of 0.35.  The other class is marked with the blue squares and has a mean of 0.65. The size of each training class is 20. </p><p>Each class shows up twice. Once as part of the x-axis which is the data space for this problem. The second time I show them as data points (x,y) used in the linear regression. Obviously the red triangles all have y = -1, and the blue squares all have y = 1. </p><p>As you can see, there is some overlap between the two data sets, because of the variance of the normal distribution. </p><p>The green line represents the best fit of the data points according to the least-squares model (LSM). The classification boundary is the point where the green line crosses the x-axis. As you can see that's somewhere around 0.5. </p><p>You would expect 0.5 to be a good estimate of the classification boundary S because the normal distribution is symmetric around the mean and both classes are equi-distant from 0.5. </p><p>The R-script generates the probability of misclassification defined as the probability of ending up on the wrong side of the estimated classification boundary : </p><pre><code> S_est = 0.5 * (mean_1 + mean_2)  
 
 P_mis_classified = Prob( x &gt; S_est) for class 1  
 		      = Prob( x &lt; S_est) for class 2  
</code></pre><p>This is obviously determined in large part by the variance (for given mean), and for this example the probability is around 16 % for both classes. </p><p>The <em>sim</em> can be used to generate a whole set of estimates of the classification boundary. This is in fact sampling the space of estimators. The mean of this sample should be very close to the actual value thanks to the <a href="http://en.wikipedia.org/wiki/Central_limit_theorem">central limit theorem.</a> Here's a typical run </p><pre><code> &gt;mean(sim(400, 0.35, 0.15, 0.65, 0.15))  
  [1] 0.4977804  
&gt; mean(sim(400, 0.35, 0.15, 0.65, 0.15))  
  [1] 0.4990484  
&gt; mean(sim(400, 0.35, 0.15, 0.65, 0.15))  
  [1] 0.5024554 </code></pre><p>The R function <em>mean</em> is used to find the mean of the values of the vector of simulation results. </p><p><a name="samplemean1d"> <img src="http://github.com/fons/blog-images/raw/master/20091101/samplemean1d.png">  </a>  </p>  </p><p><a href=""samplemean1d"">This graph</a> shows a plot of the density of the sample distribution for the mean. The graph shows two distributions one for a standard deviations 0.15 in blue and 0.35 in red respectively. </p><p>Notice how wide the distribution for sd=0.35 is around 0.5. It turns out that about 33 % of your data will be misclassified because there will be significant overlap between the two classes. </p><p><a name = "wide1d"> <img src="http://github.com/fons/blog-images/raw/master/20091101/wide1d.png">  </a>  </p>  </p><p><a href=""wide1d"">This graph</a> is generated using a standard deviation of 0.35 for both classes and with 50 data points in each class. As you can see there's significant overlap between the two classes. In fact, it would be hard to just visually pick out a good classification boundary. </p> 
	</div>
	<div id="post-timestamp-id" style="visibility:hidden">
	  <p>3466078237 </p>
	</div>
      </div>

      <div id="footer">
	<p>
	  Powered by <a href="http://www.github.com/fons/cl-bliky"> cl-bliky </a>
	</p>
      </div>
      
    </div><!-- end of main area -->

  </body>
</html>
